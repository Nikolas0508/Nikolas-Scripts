<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nikolas Scripts</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(135deg,#000814,#0a0f2c,#1a0033);
  color:white;
}

h1,h2,h3{color:#a78bfa}

.container{
  padding:30px;
  min-height:100vh;
}

.card{
  background:rgba(0,0,0,0.9);
  border:1px solid #7c3aed;
  border-radius:18px;
  padding:25px;
  margin-bottom:20px;
  animation:fadeIn 0.3s ease;
}

.full{
  width:100%;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(10px)}
  to{opacity:1; transform:translateY(0)}
}

input,button,select,textarea{
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:none;
  font-size:15px;
}

textarea{width:100%;height:120px}

button{
  background:#7c3aed;
  color:white;
  cursor:pointer;
  transition:0.2s;
}

button:hover{
  transform:scale(1.05);
  box-shadow:0 0 15px #7c3aed;
}

button:active{transform:scale(0.97)}

.script-title{color:#60a5fa;font-size:20px;font-weight:bold}
.maintenance{color:#ff4d4d;font-weight:bold}
.hidden{display:none}

.nav button{margin-right:10px}

.center{
  display:flex;
  justify-content:center;
  align-items:center;
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login" class="container center">
  <div class="card full" style="max-width:700px;">
    <h1 style="text-align:center;font-size:35px;">Nikolas Scripts</h1>
    <input id="user" placeholder="Usu√°rio" class="full">
    <input id="pass" type="password" placeholder="Senha" class="full">
    <button onclick="login()" class="full">Entrar / Solicitar Acesso</button>
  </div>
</div>

<!-- PAINEL -->
<div id="painel" class="container hidden">

  <h1>Nikolas Scripts</h1>

  <!-- NORMAL -->
  <div id="navNormal" class="nav hidden">
    <button onclick="showTab('scripts')">Scripts</button>
    <button onclick="showTab('tutorial')">Tutorial</button>
    <button onclick="logout()">Sair</button>
  </div>

  <!-- ADMIN -->
  <div id="navAdmin" class="nav hidden">
    <button onclick="showTab('adminUsers')">Admin</button>
    <button onclick="showTab('scripts')">Scripts</button>
    <button onclick="showTab('tutorial')">Tutorial</button>
    <button onclick="logout()">Sair</button>
  </div>

  <div id="scripts" class="hidden"></div>
  <div id="tutorial" class="hidden"></div>
  <div id="adminUsers" class="hidden"></div>

</div>

<script>
const ADMIN_USER="NikolasP";
const ADMIN_PASS="05082011";

let users=JSON.parse(localStorage.getItem('users')||'[]');
let pending=JSON.parse(localStorage.getItem('pending')||'[]');
let maintenance=JSON.parse(localStorage.getItem('maintenance')||'[]');
let scripts=JSON.parse(localStorage.getItem('scripts')||JSON.stringify([
  {title:"Script Teste 1",code:"javascript:(function(){alert('Teste 1');})();"},
  {title:"Script Teste 2",code:"javascript:(function(){alert('Teste 2');})();"}
]));

let currentUser=null;

function save(){
  localStorage.setItem('users',JSON.stringify(users));
  localStorage.setItem('pending',JSON.stringify(pending));
  localStorage.setItem('maintenance',JSON.stringify(maintenance));
  localStorage.setItem('scripts',JSON.stringify(scripts));
}

function login(){
  const u=user.value;
  const p=pass.value;

  if(u===ADMIN_USER && p===ADMIN_PASS){
    currentUser={username:u,admin:true};
    enter();return;
  }

  const found=users.find(x=>x.username===u && x.password===p);
  if(found){
    currentUser={username:u,admin:false};
    enter();
  }else{
    if(!pending.find(x=>x.username===u)){
      pending.push({username:u,password:p});
      save();
      alert("Solicita√ß√£o enviada para o administrador.");
    }else{
      alert("Sua solicita√ß√£o est√° pendente.");
    }
  }
}

function enter(){
  login.classList.add('hidden');
  painel.classList.remove('hidden');

  if(currentUser.admin){
    navAdmin.classList.remove('hidden');
    navNormal.classList.add('hidden');
  }else{
    navNormal.classList.remove('hidden');
    navAdmin.classList.add('hidden');
  }
}

function logout(){location.reload();}

function hideAll(){
  document.querySelectorAll('#painel > div').forEach(d=>{
    if(!d.classList.contains('nav')) d.classList.add('hidden');
  });
}

function showTab(id){
  hideAll();
  document.getElementById(id).classList.remove('hidden');
  if(id==='scripts') renderScripts();
  if(id==='tutorial') renderTutorial();
  if(id==='adminUsers') renderAdmin();
}

function renderScripts(){
  scripts.innerHTML='';

  scripts.forEach(s=>{
    const card=document.createElement('div');
    card.className='card full';

    card.innerHTML=`<div class='script-title'>${s.title}</div><pre>${s.code}</pre>`;

    if(maintenance.includes(s.title)){
      card.innerHTML+=`<div class='maintenance'>‚ö† Em manuten√ß√£o</div>`;
    }else{
      const copy=document.createElement('button');
      copy.innerText='Copiar Script';
      copy.onclick=()=>navigator.clipboard.writeText(s.code);
      card.appendChild(copy);

      if(currentUser.admin){
        const maint=document.createElement('button');
        maint.innerText='Promover Manuten√ß√£o';
        maint.onclick=()=>{
          maintenance.push(s.title);
          save();
          renderScripts();
        };
        card.appendChild(maint);
      }
    }

    scripts.appendChild(card);
  });

  if(currentUser.admin){
    const add=document.createElement('button');
    add.innerText='Add Script';
    add.onclick=()=>{
      const name=prompt('Nome do script:');
      const code=prompt('C√≥digo do script:');
      if(name&&code){scripts.push({title:name,code:code});save();renderScripts();}
    };

    const del=document.createElement('button');
    del.innerText='Apagar Script';
    del.onclick=()=>{
      const name=prompt('Nome do script para apagar:');
      scripts=scripts.filter(x=>x.title!==name);
      maintenance=maintenance.filter(x=>x!==name);
      save();renderScripts();
    };

    scripts.appendChild(add);
    scripts.appendChild(del);
  }
}

function renderTutorial(){
  tutorial.innerHTML=`
  <div class='card full'>
  <h2>Como usar Bookmarklet</h2>
  <h3>üíª Computador</h3>
  <ol>
  <li>Copie o script.</li>
  <li>Pressione CTRL + SHIFT + B.</li>
  <li>Clique com bot√£o direito ‚Üí Novo Favorito.</li>
  <li>Cole o c√≥digo no campo URL.</li>
  <li>Clique no favorito para executar.</li>
  </ol>
  <h3>üì± Celular</h3>
  <ol>
  <li>Copie o script.</li>
  <li>Crie um favorito.</li>
  <li>Edite o favorito.</li>
  <li>Cole o c√≥digo no campo URL.</li>
  <li>Salve e toque para executar.</li>
  </ol>
  </div>`;
}

function renderAdmin(){
  adminUsers.innerHTML='';

  const card1=document.createElement('div');
  card1.className='card full';
  card1.innerHTML='<h2>Logins Pendentes</h2>';

  pending.forEach(u=>{
    const div=document.createElement('div');
    div.innerHTML=`${u.username}<br>`;

    const a=document.createElement('button');
    a.innerText='Aceitar';
    a.onclick=()=>{users.push(u);pending=pending.filter(x=>x.username!==u.username);save();renderAdmin();};

    const r=document.createElement('button');
    r.innerText='Recusar';
    r.onclick=()=>{pending=pending.filter(x=>x.username!==u.username);save();renderAdmin();};

    div.appendChild(a);div.appendChild(r);
    card1.appendChild(div);
  });

  const card2=document.createElement('div');
  card2.className='card full';
  card2.innerHTML='<h2>Usu√°rios Aprovados</h2>';

  users.forEach(u=>{
    const div=document.createElement('div');
    div.innerHTML=`${u.username}<br>`;

    const remove=document.createElement('button');
    remove.innerText='Remover';
    remove.onclick=()=>{
      users=users.filter(x=>x.username!==u.username);
      save();
      alert('Licen√ßa removida. Usu√°rio deve solicitar novamente.');
      renderAdmin();
    };

    div.appendChild(remove);
    card2.appendChild(div);
  });

  adminUsers.appendChild(card1);
  adminUsers.appendChild(card2);
}

</script>

</body>
</html>
