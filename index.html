<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nikolas Scripts</title>
<style>
body{
    margin:0;
    font-family:Arial;
    background:#0a0f1f;
    color:white;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
.container{
    background:#111a2e;
    padding:40px;
    border-radius:15px;
    width:420px;
    box-shadow:0 0 20px #6a00ff;
    text-align:center;
}
input{
    width:100%;
    padding:12px;
    margin:10px 0;
    border-radius:8px;
    border:none;
    background:#1e2a4a;
    color:white;
}
button{
    width:100%;
    padding:12px;
    margin:10px 0;
    border:none;
    border-radius:8px;
    background:linear-gradient(45deg,#6a00ff,#001aff);
    color:white;
    cursor:pointer;
    transition:0.2s;
}
button:hover{
    transform:scale(1.05);
    box-shadow:0 0 10px #6a00ff;
}
.hidden{display:none;}
.scriptBox{
    background:#1e2a4a;
    padding:15px;
    border-radius:10px;
    margin:10px 0;
}
.maintenance{
    opacity:0.5;
}
</style>
</head>
<body>

<div class="container" id="loginBox">
    <h2>Nikolas Scripts</h2>
    <input id="username" placeholder="Usuário">
    <input id="password" type="password" placeholder="Senha">
    <button onclick="login()">Entrar / Criar</button>
    <p id="loginMsg"></p>
</div>

<div class="container hidden" id="home">
    <h2>Menu</h2>
    <button onclick="openScripts()">Scripts</button>
    <button onclick="openTutorial()">Tutorial</button>
    <button id="adminPanelBtn" class="hidden" onclick="openAdmin()">Admin</button>
    <button onclick="logout()">Sair</button>
</div>

<div class="container hidden" id="scriptsPage">
    <h2>Scripts</h2>
    <div id="scriptsList"></div>
    <button onclick="backHome()">Voltar</button>
</div>

<div class="container hidden" id="tutorialPage">
    <h2>Como usar Bookmarklet</h2>
    <p><b>Computador:</b></p>
    <p>1. Copie o script.</p>
    <p>2. Pressione CTRL + SHIFT + B.</p>
    <p>3. Clique com botão direito na barra de favoritos.</p>
    <p>4. Clique em "Adicionar página".</p>
    <p>5. Apague a URL e cole o script.</p>
    <p>6. Salve e clique nele para executar.</p>
    <br>
    <p><b>Celular:</b></p>
    <p>1. Copie o script.</p>
    <p>2. Crie um favorito qualquer.</p>
    <p>3. Edite o favorito.</p>
    <p>4. Apague a URL.</p>
    <p>5. Cole o script.</p>
    <p>6. Salve e execute.</p>
    <button onclick="backHome()">Voltar</button>
</div>

<div class="container hidden" id="adminPage">
    <h2>Painel Admin</h2>

    <h3>Logins Pendentes</h3>
    <div id="pendingList"></div>

    <h3>Usuários Aprovados</h3>
    <div id="approvedList"></div>

    <h3>Scripts</h3>
    <input id="newScriptName" placeholder="Nome do Script">
    <input id="newScriptCode" placeholder="Código do Script">
    <button onclick="addScript()">Adicionar Script</button>

    <h3>Modo Manutenção</h3>
    <div id="maintenanceList"></div>

    <button onclick="backHome()">Voltar</button>
</div>

<script>
let adminUser="NikolasP";
let adminPass="05082011";

let users=JSON.parse(localStorage.getItem("users"))||{};
let pendingUsers=JSON.parse(localStorage.getItem("pendingUsers"))||{};
let scripts=JSON.parse(localStorage.getItem("scripts"))||{
    "Script Teste":"javascript:alert('Funcionando!')"
};
let maintenance=JSON.parse(localStorage.getItem("maintenance"))||{};

function save(){
    localStorage.setItem("users",JSON.stringify(users));
    localStorage.setItem("pendingUsers",JSON.stringify(pendingUsers));
    localStorage.setItem("scripts",JSON.stringify(scripts));
    localStorage.setItem("maintenance",JSON.stringify(maintenance));
}

function login(){
    let u=username.value;
    let p=password.value;

    if(u===adminUser && p===adminPass){
        showHome(true);
        return;
    }

    if(users[u] && users[u]===p){
        showHome(false);
    }else if(pendingUsers[u]){
        loginMsg.innerText="Aguardando aprovação.";
    }else{
        pendingUsers[u]=p;
        save();
        loginMsg.innerText="Solicitação enviada!";
    }
}

function showHome(isAdmin){
    loginBox.classList.add("hidden");
    home.classList.remove("hidden");
    if(isAdmin){
        adminPanelBtn.classList.remove("hidden");
        loadAdmin();
    }
}

function logout(){
    location.reload();
}

function openScripts(){
    home.classList.add("hidden");
    scriptsPage.classList.remove("hidden");
    loadScripts();
}

function openTutorial(){
    home.classList.add("hidden");
    tutorialPage.classList.remove("hidden");
}

function openAdmin(){
    home.classList.add("hidden");
    adminPage.classList.remove("hidden");
    loadAdmin();
}

function backHome(){
    scriptsPage.classList.add("hidden");
    tutorialPage.classList.add("hidden");
    adminPage.classList.add("hidden");
    home.classList.remove("hidden");
}

function loadScripts(){
    scriptsList.innerHTML="";
    for(let name in scripts){
        let div=document.createElement("div");
        div.className="scriptBox";
        if(maintenance[name]) div.classList.add("maintenance");
        div.innerHTML="<b>"+name+"</b><br>";
        if(!maintenance[name]){
            div.innerHTML+="<button onclick=\"copyScript('"+name+"')\">Copiar</button>";
        }else{
            div.innerHTML+="<p>⚠ Em manutenção</p>";
        }
        scriptsList.appendChild(div);
    }
}

function copyScript(name){
    navigator.clipboard.writeText(scripts[name]);
    alert("Script copiado!");
}

function loadAdmin(){
    pendingList.innerHTML="";
    approvedList.innerHTML="";
    maintenanceList.innerHTML="";

    for(let u in pendingUsers){
        let div=document.createElement("div");
        div.innerHTML=u+
        "<button onclick=\"approveUser('"+u+"')\">Aceitar</button>"+
        "<button onclick=\"rejectUser('"+u+"')\">Recusar</button>";
        pendingList.appendChild(div);
    }

    for(let u in users){
        let div=document.createElement("div");
        div.innerHTML=u+
        "<button onclick=\"removeUser('"+u+"')\">Remover Licença</button>";
        approvedList.appendChild(div);
    }

    for(let name in scripts){
        let div=document.createElement("div");
        div.innerHTML=name+
        "<button onclick=\"toggleMaintenance('"+name+"')\">"+
        (maintenance[name]?"Desativar":"Ativar")+
        "</button>";
        maintenanceList.appendChild(div);
    }
}

function approveUser(u){
    users[u]=pendingUsers[u];
    delete pendingUsers[u];
    save();
    loadAdmin();
}

function rejectUser(u){
    delete pendingUsers[u];
    save();
    loadAdmin();
}

function removeUser(u){
    delete users[u];
    save();
    loadAdmin();
}

function addScript(){
    let n=newScriptName.value;
    let c=newScriptCode.value;
    if(n && c){
        scripts[n]=c;
        save();
        loadAdmin();
    }
}

function toggleMaintenance(name){
    maintenance[name]=!maintenance[name];
    save();
    loadAdmin();
}
</script>

</body>
</html>
